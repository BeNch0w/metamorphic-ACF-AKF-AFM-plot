# 变质岩三元图解绘图工具 (Metamorphic Rock Ternary Plotter)

这是一个用于变质岩石地球化学研究的网页工具。

它允许用户通过一个类似Excel的界面输入全岩主量元素数据，并快速绘制专业的 **ACF**、**A'KF** 和 **AFM** 三元图解。该工具完全在您的浏览器本地运行，无需互联网连接（打开文件后）或复杂的软件安装。

<img width="1802" height="933" alt="image" src="https://github.com/user-attachments/assets/06bdcb0a-0cf4-402e-bad7-63363eb894c2" />


---

## 🌟 功能特性

* **交互式图表**：基于 Plotly.js，可缩放、平移，并一键下载为 **SVG 矢量图**。
* **Excel式表格**：基于 Handsontable，可直接从Excel或WPS中**复制粘贴数据**。
* **样品分组 (Group)**：支持在 `Group` 列中为样品分类，图表将自动为不同组别应用**不同的标记形状**（圆形、方形、菱形等）。
* **灵活的全铁 (FeT) 处理**：允许用户在 `Fe₂O₃T` 和 `FeOT` 两种全铁输入格式之间自由切换。
* **多种计算方法**：为ACF和AFM图提供了多种经典的计算投影公式（例如 Thompson 1957 白云母/钾长石投影），并可自由选择。
* **公式透明显示**：在绘图时自动在图表下方显示当前所使用的**摩尔计算公式**，确保学术严谨性。
* **智能标签**：样品标签和标记可以（正确地）显示在三角形坐标轴之外，不会被裁切。

---

## 🚀 如何使用

1.  **下载文件**：下载本仓库中的 `变质岩三角图投图.html` 文件到您的电脑上。
2.  **打开工具**：直接用您的浏览器（推荐 Chrome, Firefox, Edge）**双击打开**这个.html文件。
3.  **输入数据**：在左侧的“全岩成分表”中粘贴或输入您的数据。
    * **重要提示**：请确保您的数据列顺序与表格标题行（`Sample ID`, `Group`, `SiO₂`, `TiO₂`, `Al₂O₃`, `FeT`...）**完全一致**。
4.  **选择选项**：
    * 在“全铁输入格式”中，选择您 `FeT` 列的数据是 `Fe₂O₃` 还是 `FeO`。
    * 在“计算方法”中，为您要绘制的图表选择投影公式。
5.  **绘图与下载**：
    * 点击“绘制 ACF 图”、“绘制 A'KF 图”或“绘制 AFM 图”按钮。
    * 图表将显示在右侧。将鼠标悬停在图表右上角，点击**相机图标** 📷 即可下载为 SVG 格式。

---

## 📋 表格数据格式

为了确保程序正确计算，请务必遵循以下列顺序。表格的第一行为空行，方便您直接粘贴数据。

| 列名 | 数据类型 | 描述 |
| :--- | :--- | :--- |
| **Sample ID** | 文本 | 样品名称（将显示为标签） |
| **Group** | 文本 | 样品组别（例如 "片岩", "A组"）。同一组别将使用相同形状。 |
| **SiO₂** | 数字 | 二氧化硅 (wt%) |
| **TiO₂** | 数字 | 二氧化钛 (wt%) |
| **Al₂O₃** | 数字 | 三氧化二铝 (wt%) |
| **FeT** | 数字 | **全铁** (wt%) - **请务[!]注意[!]在选项中选择正确的格式** |
| **MnO** | 数字 | 氧化锰 (wt%) |
| **MgO** | 数字 | 氧化镁 (wt%) |
| **CaO** | 数字 | 氧化钙 (wt%) |
| **Na₂O** | 数字 | 氧化钠 (wt%) |
| **K₂O** | 数字 | 氧化钾 (wt%) |
| **P₂O₅** | 数字 | 五氧化二磷 (wt%) |

---

## 🛠️ 技术栈

* 纯 HTML, CSS & JavaScript (ES6)
* [Handsontable](https://handsontable.com/) - 用于交互式表格
* [Plotly.js](https://plotly.com/javascript/) - 用于三元图绘制

⚠️如果打开没有表格，请下载zip文件。⚠️
1.  **解压缩**：请首先将其**解压缩**到一个文件夹中（例如解压到桌面）。
2.  **打开文件夹**：进入解压缩后的 `plot-offline` 文件夹。
3.  **运行**：**双击 `变质岩三角图投图.html` 文件**。它将在您的默认浏览器（如 Chrome, Edge, Firefox）中打开并立即可用。

> **重要提示**：
> * 请保持 `变质岩三角图投图.html` 文件和 `lib` 文件夹在同一目录下。
> * 请勿删除 `lib` 文件夹或更改其内部文件，它们是本工具运行所需的核心“零件”。
> * 此版本**无需互联网**即可运行。

---

## 📂 文件夹结构

本软件包包含以下文件：
MetaPlot-Offline/ 
   ├── index.html (<- 双击此文件以运行软件) 
   └── lib/ (<- 核心库文件夹，请勿移动) 
      ├── handsontable.full.min.css 
      ├── handsontable.full.min.js 
      └── plotly-2.32.0.min.js
